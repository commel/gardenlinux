#!/usr/bin/env bash

set -eufo pipefail

mem="$(grep MemTotal /proc/meminfo | awk '{ print $2 }')"
swap="$(grep SwapTotal /proc/meminfo | awk '{ print $2 }')"

free -h

size="$(( mem / 2 + ( swap / 5 ) * 4 ))"
echo "resizing $1 to ${size}k"

mount -o "remount,size=${size}k" "$1"
